<mvc:View
    controllerName="tripjournal.tripjournalui.controller.TripJournal"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
>
    <Page id="tripJournalPage" title="{i18n>appTitle}">
        <subHeader>
            <Toolbar id="filterBar">
                <Title id="_IDGenTitle" text="{i18n>filterBy}" />
                <Select
                    id="statusFilter"
                    width="15rem"
                    items="{
                        path: '/ZbnhStatusSet'
                    }"
                >
                    <core:Item id="_IDGenItem2" key="{Code}" text="{Text}" />
                </Select>
                <Select id="yearFilter"  width="9rem" items="{years>/}">
                    <core:Item id="_IDGenItem6" key="{years>key}" text="{years>text}"/>
                </Select>

                <Select id="monthFilter" width="11rem" items="{months>/}">
                    <core:Item id="_IDGenItem7" key="{months>key}" text="{months>text}"/>
                </Select>

                <Input  id="licensePlateFilter"
                        width="15rem"
                        placeholder="{i18n>licensePlate}"
                        showValueHelp="true"
                        valueHelpRequest=".onCarValueHelpRequest"/>
                <ToolbarSpacer id="_IDGenToolbarSpacer" />
                <Button id="_IDGenButton3"
                    text="{i18n>filterButtonText}"
                    press=".onFilterTrips"
                    type="Emphasized"
                />
                 <Button id="_IDGenButton4"
                    text="{i18n>clearFilterButtonText}"
                    press=".onClearFilter"
                />
            </Toolbar>
        </subHeader>
        <content>
            <Table
                id="tripHeaderTable"
                inset="false"
                mode="MultiSelect"
                selectionChange=".onSelectionChange"
                items="{
                    path : '/TripHeaderSet',
                    parameters : {
                        expand  : 'to_TripItemSet',                              
                        select  : 'Username,Yyear,Mmonth,LicensePlate,KmBefore,Status,Note,to_TripItemSet/Distance'
                    },
                        sorter : { path : 'Yyear', descending : true }
                    }"
                class="sapUiResponsiveMargin"
                width="auto"
            >
                <headerToolbar>
                    <Toolbar id="_IDGenToolbar">
                        <Title id="_IDGenTitle1" text="{i18n>tripsTitle}" level="H2"/>
                        <ToolbarSpacer id="_IDGenToolbarSpacer1"/>
                        <Button id="editHeaderBtn"  icon="sap-icon://edit"
                                enabled="false" press=".onOpenEditHeaderDialog"/>
                        <Button
                            id="newTripButton"
                            icon="sap-icon://add"
                            tooltip="{i18n>newTripTooltip}"
                            press=".onOpenCreateDialog"
                        />
                    </Toolbar>
                </headerToolbar>
                <columns>
                    <Column id="_IDGenColumn"><Text id="_IDGenText" text="{i18n>colLicensePlate}" /></Column>
                    <Column id="_IDGenColumn1"><Text id="_IDGenText1" text="{i18n>colDate}" /></Column>
                    <Column id="_IDGenColumn2" minScreenWidth="Tablet" demandPopin="true"><Text id="_IDGenText2" text="{i18n>colStatus}" /></Column>
                    <Column id="_IDGenColumn3" minScreenWidth="Tablet" demandPopin="true" hAlign="End"><Text id="_IDGenText3" text="{i18n>colItemCount}" /></Column>
                    <Column id="_IDGenColumn4" minScreenWidth="Desktop" demandPopin="true" hAlign="End"><Text id="_IDGenText4" text="{i18n>colKmBefore}" /></Column>
                    <Column id="_IDGenColumn5" minScreenWidth="Desktop" demandPopin="true" hAlign="End"><Text id="_IDGenText5" text="{i18n>colKmAfter}" /></Column>
                    <Column id="_IDGenColumn6" minScreenWidth="Desktop" demandPopin="true"><Text id="_IDGenText6" text="{i18n>colNote}" /></Column>
                </columns>
                <items>
                    <ColumnListItem id="_IDGenColumnListItem"
                        type="Navigation"
                        press=".onNavToDetails"
                    >
                        <cells>
                            <Text id="_IDGenText7" text="{LicensePlate}" />
                            <Text id="_IDGenText8" text="{= ${Yyear} + '. ' + ${Mmonth}}" />
                            <ObjectStatus id="_IDGenObjectStatus"
                                text="{
                                    path: 'Status',
                                    formatter: '.formatter.formatStatusText'
                                }"
                                state="{
                                    path: 'Status',
                                    formatter: '.formatter.formatStatusState'
                                }"
                            />
                            <Text id="_IDGenText9" text="{
                                parts: ['to_TripItemSet'],
                                formatter: '.formatter.formatItemCount'
                            }" />
                            <ObjectNumber id="_IDGenObjectNumber"
                                number="{
                                    path: 'KmBefore',
                                    type: 'sap.ui.model.type.Integer'
                                }"
                                unit="km"
                            />
                            <ObjectNumber id="_IDGenObjectNumber1"
                                number="{
                                    parts: ['KmBefore','to_TripItemSet'],
                                    formatter: '.formatter.formatKmAfter'
                                }"
                                unit="km"/>

                            <Text id="_IDGenText10" text="{Note}" />
                        </cells>
                    </ColumnListItem>
                </items>
            </Table>
        </content>
    </Page>
</mvc:View>